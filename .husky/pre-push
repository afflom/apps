echo "Running essential checks for push..."
npm run typecheck && npm run lint && npm run format:check && npx vitest run src/simple.test.ts src/utils/dom.test.ts

echo ""
echo "Running dev deployment before pushing to production..."

# Use npm run deploy:dev script which is designed for this purpose
npm run deploy:dev -- --no-interactive

# Check if deployment was successful
if [ $? -ne 0 ]; then
  echo "ERROR: Dev deployment failed. Fix deployment issues before pushing to production."
  exit 1
fi

echo "Dev deployment completed successfully."
